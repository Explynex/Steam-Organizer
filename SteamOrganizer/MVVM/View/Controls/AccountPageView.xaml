<Grid x:Class="SteamOrganizer.MVVM.View.Controls.AccountPageView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:viewModel="clr-namespace:SteamOrganizer.MVVM.ViewModels"
      xmlns:Icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:ext="clr-namespace:SteamOrganizer.MVVM.View.Extensions"
      xmlns:glob="clr-namespace:System.Globalization;assembly=mscorlib"
      mc:Ignorable="d" 
      d:DesignHeight="900" d:DesignWidth="780"
      d:Background="{DynamicResource PrimaryBackgroundBrush}"
      FocusVisualStyle="{x:Null}"
      d:DataContext="{d:DesignInstance viewModel:AccountPageViewModel}">
    <Grid.Resources>
        
        <!--#region Icons -->
        <Path x:Key="RockstarIcon"
              Stretch="Uniform"
              Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ToggleButton}}}" 
              Data="M370 2147 c0 -3 -16 -81 -35 -174 -20 -92 -56 -265 -80 -383 -24 -118 -71 -345 -104 -505 -33 -159 -57 -293 -55 -297 6 -10 295 -10 310 0 6 4 27 97 47 208 20 110 41 224 48 252 l11 52 133 0 c172 0 225 -11 264 -55 46 -52 57 -122 43 -268 -6 -67 -8 -138 -4 -157 l8 -35 113 -5 114 -5 89 -97 90 -97 -106 -232 c-59 -128 -105 -233 -103 -235 1 -2 101 56 222 128 121 72 227 133 235 135 9 2 89 -53 184 -127 93 -71 170 -129 172 -127 2 2 -12 100 -31 218 l-34 214 27 23 c15 12 102 75 194 140 92 64 167 120 168 124 0 4 -98 9 -217 10 l-218 3 -34 213 c-19 116 -37 212 -40 212 -4 0 -64 -97 -135 -215 l-129 -215 -112 0 -113 0 -7 38 c-3 20 -5 118 -4 217 3 183 -1 206 -45 305 -4 11 7 23 38 43 129 81 204 269 176 440 -20 126 -74 188 -199 229 -62 20 -89 22 -473 26 -225 2 -408 2 -408 -1z m708 -270 c66 -36 88 -110 57 -196 -21 -61 -58 -104 -117 -137 l-53 -29 -197 0 c-186 0 -198 1 -198 18 0 17 63 307 76 350 5 17 19 18 202 15 167 -3 202 -6 230 -21z"
              >
            <Path.LayoutTransform>
                <ScaleTransform ScaleY="-1"/>
            </Path.LayoutTransform>

        </Path>

        <Path x:Key="EpicGamesIcon"
              Stretch="Uniform"
              Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ToggleButton}}}" 
              Data="M3.537 0C2.165 0 1.66.506 1.66 1.879V18.44a4.262 4.262 0 00.02.433c.031.3.037.59.316.92.027.033.311.245.311.245.153.075.258.13.43.2l8.335 3.491c.433.199.614.276.928.27h.002c.314.006.495-.071.928-.27l8.335-3.492c.172-.07.277-.124.43-.2 0 0 .284-.211.311-.243.28-.33.285-.621.316-.92a4.261 4.261 0 00.02-.434V1.879c0-1.373-.506-1.88-1.878-1.88zm13.366 3.11h.68c1.138 0 1.688.553 1.688 1.696v1.88h-1.374v-1.8c0-.369-.17-.54-.523-.54h-.235c-.367 0-.537.17-.537.539v5.81c0 .369.17.54.537.54h.262c.353 0 .523-.171.523-.54V8.619h1.373v2.143c0 1.144-.562 1.71-1.7 1.71h-.694c-1.138 0-1.7-.566-1.7-1.71V4.82c0-1.144.562-1.709 1.7-1.709zm-12.186.08h3.114v1.274H6.117v2.603h1.648v1.275H6.117v2.774h1.74v1.275h-3.14zm3.816 0h2.198c1.138 0 1.7.564 1.7 1.708v2.445c0 1.144-.562 1.71-1.7 1.71h-.799v3.338h-1.4zm4.53 0h1.4v9.201h-1.4zm-3.13 1.235v3.392h.575c.354 0 .523-.171.523-.54V4.965c0-.368-.17-.54-.523-.54zm-3.74 10.147a1.708 1.708 0 01.591.108 1.745 1.745 0 01.49.299l-.452.546a1.247 1.247 0 00-.308-.195.91.91 0 00-.363-.068.658.658 0 00-.28.06.703.703 0 00-.224.163.783.783 0 00-.151.243.799.799 0 00-.056.299v.008a.852.852 0 00.056.31.7.7 0 00.157.245.736.736 0 00.238.16.774.774 0 00.303.058.79.79 0 00.445-.116v-.339h-.548v-.565H7.37v1.255a2.019 2.019 0 01-.524.307 1.789 1.789 0 01-.683.123 1.642 1.642 0 01-.602-.107 1.46 1.46 0 01-.478-.3 1.371 1.371 0 01-.318-.455 1.438 1.438 0 01-.115-.58v-.008a1.426 1.426 0 01.113-.57 1.449 1.449 0 01.312-.46 1.418 1.418 0 01.474-.309 1.58 1.58 0 01.598-.111 1.708 1.708 0 01.045 0zm11.963.008a2.006 2.006 0 01.612.094 1.61 1.61 0 01.507.277l-.386.546a1.562 1.562 0 00-.39-.205 1.178 1.178 0 00-.388-.07.347.347 0 00-.208.052.154.154 0 00-.07.127v.008a.158.158 0 00.022.084.198.198 0 00.076.066.831.831 0 00.147.06c.062.02.14.04.236.061a3.389 3.389 0 01.43.122 1.292 1.292 0 01.328.17.678.678 0 01.207.24.739.739 0 01.071.337v.008a.865.865 0 01-.081.382.82.82 0 01-.229.285 1.032 1.032 0 01-.353.18 1.606 1.606 0 01-.46.061 2.16 2.16 0 01-.71-.116 1.718 1.718 0 01-.593-.346l.43-.514c.277.223.578.335.9.335a.457.457 0 00.236-.05.157.157 0 00.082-.142v-.008a.15.15 0 00-.02-.077.204.204 0 00-.073-.066.753.753 0 00-.143-.062 2.45 2.45 0 00-.233-.062 5.036 5.036 0 01-.413-.113 1.26 1.26 0 01-.331-.16.72.72 0 01-.222-.243.73.73 0 01-.082-.36v-.008a.863.863 0 01.074-.359.794.794 0 01.214-.283 1.007 1.007 0 01.34-.185 1.423 1.423 0 01.448-.066 2.006 2.006 0 01.025 0zm-9.358.025h.742l1.183 2.81h-.825l-.203-.499H8.623l-.198.498h-.81zm2.197.02h.814l.663 1.08.663-1.08h.814v2.79h-.766v-1.602l-.711 1.091h-.016l-.707-1.083v1.593h-.754zm3.469 0h2.235v.658h-1.473v.422h1.334v.61h-1.334v.442h1.493v.658h-2.255zm-5.3.897l-.315.793h.624zm-1.145 5.19h8.014l-4.09 1.348z"
        />

        <Path x:Key="UbisoftIcon"
              Stretch="Uniform"
              Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ToggleButton}}}" 
              Data="M11.41,2C5.21,2 2.53,7.53 2.53,7.53L3.32,8.09C3.32,8.09 2.33,10 2.35,12.4C2.35,17.34 6.29,22 12.07,22C17.33,22 21.67,17.71 21.67,12.41C21.67,5.5 16.31,2 11.41,2M11.47,3.69C16.31,3.69 20.07,7.6 20.07,12.14C20.07,16.95 16.45,20.3 12.23,20.3C9.13,20.3 6.33,17.94 6.33,14.7C6.33,12.82 7.32,11.5 8.44,10.82L8.6,11C8.3,11.24 7.43,12.64 7.43,14C7.43,16.56 9.43,18.33 11.95,18.33C15.16,18.33 17.3,15.59 17.3,12.41C17.3,8.71 14.03,5.57 10.1,5.57C7.93,5.57 6.09,6.5 5.03,7.33L4.86,7.18C6.25,5.04 8.65,3.69 11.47,3.69M10,7.23C12.53,7.23 14.97,8.89 15.59,11.25L15.36,11.33C14.27,9.88 12.47,8.68 10.35,8.68C6.44,8.68 4.39,12.23 4.69,15.19L4.46,15.28C4.46,15.28 4.03,14.33 4.03,13.2C4.03,9.93 6.71,7.23 10,7.23M11.68,11.33C12.86,11.33 13.81,12.3 13.81,13.44C13.81,14.38 13.21,14.94 13.21,14.94L13.92,15.45C13.92,15.45 13.21,16.57 11.76,16.57C10.37,16.57 9.13,15.44 9.13,13.93C9.13,12.38 10.47,11.33 11.68,11.33Z"
        />

        <Path x:Key="EAIcon"
              Stretch="Uniform"
              Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ToggleButton}}}" 
              Data="M158 172l-21 34 137-1 21-33zm165 0l-85 134h-94l22-33h58l21-33H116l-22 33h31l-42 67h174l66-105 24 38h-21l-21 33h63l21 34h40z"
        />

        <Path x:Key="EmailIcon"
              Stretch="Uniform"
              Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ToggleButton}}}" 
              Data="M19 4H5A3 3 0 0 0 2 7V17a3 3 0 0 0 3 3H19a3 3 0 0 0 3-3V7A3 3 0 0 0 19 4Zm-.41 2-5.88 5.88a1 1 0 0 1-1.42 0L5.41 6ZM20 17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7.41l5.88 5.88a3 3 0 0 0 4.24 0L20 7.41Z"
        />
        <!--#endregion-->
        
        <Style x:Key="Links" TargetType="TextBlock">
            <Setter Property="Padding" Value="0 10 0 10"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Foreground" Value="{DynamicResource SecondaryForegroundBrush}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="{DynamicResource TertiaryForegroundBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <ControlTemplate x:Key="BanChipTemplate" TargetType="ContentControl">
            <Border Background="{DynamicResource BackgroundGrad}"
                    FocusVisualStyle="{x:Null}"
                    Padding="15 13 15 13" MinHeight="50"
                    CornerRadius="12" Width="225">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <TextBlock  Text="{TemplateBinding Uid}"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Left"/>
                    <Icon:PackIconMaterial x:Name="Icon" 
                                           Kind="CheckDecagram" 
                                           VerticalAlignment="Center"   
                                           Foreground="{DynamicResource SuccessGrad}"
                                           HorizontalAlignment="Right" 
                                           Width="25" Height="25"/>

                    <TextBlock x:Name="BanDescription"
                               Visibility="Collapsed"
                               Text="{TemplateBinding Content}"
                               TextWrapping="Wrap"
                               Grid.Row="1"
                               Foreground="{DynamicResource PrimarySubBrush}"
                               Margin="0 7 0 0"
                               FontWeight="Normal" FontSize="12"/>
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding Tag,RelativeSource={RelativeSource Self},Converter={StaticResource ToBooleanConverter}}" Value="True">
                    <Setter TargetName="BanDescription" Property="Visibility" Value="Visible"/>
                    <Setter TargetName="Icon" Property="Kind" Value="{x:Static Icon:PackIconMaterialKind.AlertDecagram}"/>
                    <Setter TargetName="Icon" Property="Foreground" Value="PaleVioletRed"/>
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <ContextMenu x:Key="FriendsContextMenu">
            <MenuItem Icon="{x:Static Icon:PackIconMaterialKind.TicketAccount}"
                      Command="{Binding OpenFriendPageCommand,Mode=OneTime}"
                      CommandParameter="{Binding RelativeSource={RelativeSource Self},Path=Parent.Tag}"
                      Header="Account page"/>
            <MenuItem Icon="{x:Static Icon:PackIconMaterialKind.AndroidMessages}"
                      Visibility="{Binding OnlineControlsVis,Mode=OneWay}"
                      Header="Send message"/>
            <MenuItem Icon="{x:Static Icon:PackIconMaterialKind.AccountRemove}"
                      Visibility="{Binding OnlineControlsVis,Mode=OneWay}"
                      Header="Remove friend" Foreground="{DynamicResource ErrorBrush}"/>
        </ContextMenu>

        <ContextMenu x:Key="GamesContextMenu">
            
            <MenuItem Icon="{x:Static Icon:PackIconMaterialKind.Database}"
                      Command="{Binding OpenInSteamDb,Mode=OneTime}"
                      CommandParameter="{Binding RelativeSource={RelativeSource Self},Path=Parent.Tag}"
                      Header="Open in SteamDB"/>
            
            <MenuItem Icon="{x:Static Icon:PackIconMaterialKind.Steam}"
                      Command="{Binding InstallGameCommand,Mode=OneTime}"
                      CommandParameter="{Binding RelativeSource={RelativeSource Self},Path=Parent.Tag}"
                      Header="Install on computer"/>
        </ContextMenu>

        <ControlTemplate x:Key="ContainerTemplate" TargetType="DataGridCell">
            <StackPanel Orientation="Horizontal" x:Name="sas">

                    <Icon:PackIconMaterial Kind="Plus" Width="10" Height="10"
                                           VerticalAlignment="Center" Cursor="Hand"
                                           Background="Transparent" Margin="0 0 5 0"
                                           ContextMenu="{TemplateBinding Tag}"
                                           PreviewMouseLeftButtonDown="OpenContextMenu"/>

                <Rectangle Width="{TemplateBinding MinWidth}" Height="{TemplateBinding MinHeight}" Cursor="Hand" 
               Opacity="0.9" RadiusX="3" RadiusY="3" Margin="0 0 5 0"
               Stroke="{DynamicResource LightBlueGrad}"
               StrokeThickness="2" StrokeDashArray="41"
               StrokeDashCap="Triangle">
                    <Rectangle.Fill>
                        <ImageBrush ImageSource="{Binding BitmapSource,Mode=OneTime}" />
                    </Rectangle.Fill>
                </Rectangle>
            </StackPanel>

        </ControlTemplate>

    </Grid.Resources>

    <Popup x:Name="SearchPopup" AllowsTransparency="True" PopupAnimation="Slide"
           Placement="Bottom" StaysOpen="False" VerticalOffset="5" HorizontalOffset="10">
        <TextBox Style="{StaticResource  SearchTextBox}" Width="300"
                 Effect="{StaticResource LightShadow}" Margin="5"
                 Uid="Search . . ."
                 Tag="{Binding ClearSearchBarCommand,Mode=OneTime}"
                 Text="{Binding SearchBarText,UpdateSourceTrigger=PropertyChanged}"
                 Foreground="{DynamicResource SecondaryForegroundBrush}"
                 Background="{DynamicResource SecondaryBackgroundBrush}"/>
    </Popup>
    

    <ScrollViewer x:Name="Scroll">
        <DockPanel VerticalAlignment="Top" Margin="0 10 0 10"
               HorizontalAlignment="Center">

        <!-- Left area -->
        <StackPanel Width="250">

            <!--#region Avatar -->
            
            <Border CornerRadius="5"
                Padding="0 20 0 15" x:Name="sas"
                Background="{DynamicResource SecondaryBackgroundBrush}">

                <StackPanel Margin="15 0 15 0">
                    <Border CornerRadius="5" 
                        Width="140" Height="140" 
                        BorderBrush="{DynamicResource LightBlueGrad}"
                        BorderThickness="3"
                        HorizontalAlignment="Center">
                        <Border.Background>
                            <ImageBrush ImageSource="{Binding FullAvatar,Mode=OneWay}"/>
                        </Border.Background>
                    </Border>

                    <TextBlock Margin="0 10 0 0" 
                           HorizontalAlignment="Center"
                           Text="{Binding CurrentAccount.Nickname,Mode=OneWay}"
                           Foreground="{DynamicResource TertiaryForegroundBrush}"
                           FontWeight="Medium"
                           Opacity="0.9"
                           FontSize="14"/>

                    <Rectangle Margin="-15 10 -15 10"
                           Height="3" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <TextBlock Text="Added: "
                           Foreground="{DynamicResource SecondaryForegroundBrush}"
                           FontSize="12">
                        <Run Text="{Binding CurrentAccount.AddedDate,Mode=OneWay,StringFormat=f,ConverterCulture={x:Static glob:CultureInfo.CurrentCulture}}"/>
                    </TextBlock>

                    <TextBlock Text="Updated: "
                           Margin="0 5 0 0"
                           Foreground="{DynamicResource SecondaryForegroundBrush}"
                           FontSize="12">
                        <Run Text="{Binding CurrentAccount.LastUpdateDate,Mode=OneWay,TargetNullValue=—,StringFormat=f,ConverterCulture={x:Static glob:CultureInfo.CurrentCulture}}" />
                    </TextBlock>

                        <ext:HoverButton x:Name="UpdateButton"
                                         Margin="0 10 0 0"
                                         Command="{Binding UpdateCommand,Mode=OneTime}"
                                         Content="Update"
                                         HorizontalAlignment="Center"
                                         MinWidth="140"/>
                    </StackPanel>

            </Border>

            <!--#endregion-->

            <!--#region Summaries -->
            
            <Border CornerRadius="5"
                    Visibility="{Binding AdditionalControlsVis,Mode=OneWay}"
                    Background="{DynamicResource SecondaryBackgroundBrush}"
                    Padding="0 20 0 15"
                    Margin="0 10 0 0" TextBlock.FontSize="14"
                    TextBlock.FontWeight="Medium">
                <StackPanel Margin="15 0 15 0">

                    <TextBlock Foreground="{DynamicResource SecondaryForegroundBrush}"
                               Margin="0 0 0 5">
                        <Run Text="Steam level:" FontWeight="Normal"/>
                        <Run Text="{Binding CurrentAccount.SteamLevel,TargetNullValue=—}" Foreground="{DynamicResource PrimarySubBrush}"/>
                    </TextBlock>

                    <TextBlock Foreground="{DynamicResource SecondaryForegroundBrush}"
                               Margin="0 0 0 10">
                        <Run Text="Profile visibility:" FontWeight="Normal"/>
                        <Run Foreground="{DynamicResource PrimarySubBrush}">
                            <Run.Style>
                                <Style TargetType="Run">
                                    <Setter Property="Text" Value="{DynamicResource apv_private}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding CurrentAccount.VisibilityState}" Value="2">
                                            <Setter Property="Text" Value="{DynamicResource apv_forFriends}"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding CurrentAccount.VisibilityState}" Value="3">
                                            <Setter Property="Text" Value="{DynamicResource apv_public}"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Run.Style>
                        </Run>
                    </TextBlock>

                    <Grid>
                        <ext:HoverButton Margin="0 0 30 0" Command="{Binding OpenAccountURLCommand,Mode=OneTime}" >
                            <TextBlock>
                            <Run Text="Steam profile"/>
                            <Icon:PackIconMaterial Kind="OpenInNew"
                                                   Width="14"
                                                   Margin="10 0 0 -3"
                                                   VerticalAlignment="Center"/>
                            </TextBlock>
                        </ext:HoverButton>

                        <Button Style="{StaticResource CopyButton}"
                                Command="{Binding CopyAccountURLCommand,Mode=OneTime}"
                                HorizontalAlignment="Right"/>
                    </Grid>


                    <Rectangle Margin="-15 10 -15 10"
                           Height="3" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <DockPanel>
                        <TextBlock Text="Steam ID" 
                                   FontWeight="Medium"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource SecondaryForegroundBrush}"/>

                        <ComboBox HorizontalAlignment="Right" x:Name="IDComboBox"
                                  Height="30" 
                                  Width="150" SelectedIndex="{Binding SelectedSteamIDType,Mode=OneWayToSource}"
                                  d:SelectedIndex="0"
                                  Background="{DynamicResource TertiaryBackgroundBrush}">
                            <ComboBoxItem IsSelected="True" Content="Account ID"/>
                            <ComboBoxItem Content="Steam ID"/>
                            <ComboBoxItem Content="Steam2 ID"/>
                            <ComboBoxItem Content="Steam3 ID"/>
                            <ComboBoxItem Content="CS:GO Friend code"/>
                            <ComboBoxItem Content="FiveM"/>
                            <ComboBoxItem Content="Vanity URL" Visibility="{Binding CurrentAccount.VanityURL,Converter={StaticResource ToVisibilityConverter}}"/>
                        </ComboBox>
                    </DockPanel>

                    <TextBlock Text="{Binding SteamIDField,Mode=OneWay}"
                               Cursor="Hand" Background="Transparent"
                               Margin="0 10 0 0"
                               HorizontalAlignment="Center"
                               FontWeight="Medium"
                               Foreground="{DynamicResource LightBlueGrad}">
                        <TextBlock.InputBindings>
                            <MouseBinding Gesture="LeftClick" 
                                          Command="{Binding CopySteamIDCommand}"
                                          CommandParameter="{Binding RelativeSource={RelativeSource AncestorLevel=1,AncestorType=TextBlock}}"/>
                        </TextBlock.InputBindings>
                    </TextBlock>
                </StackPanel>
            </Border>
            
            <!--#endregion-->

            <Border CornerRadius="5" Visibility="{Binding InteractionControlsVis,Mode=OneWay}"
                    Background="{DynamicResource SecondaryBackgroundBrush}"
                    Margin="0 10 0 0" Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        
                        <Icon:PackIconMaterial Kind="TwoFactorAuthentication"
                                           Width="30"
                                           Height="30"
                                           Foreground="{DynamicResource PrimarySubBrush}"/>
                       
                        <TextBlock Text="Auth code generator"
                               VerticalAlignment="Top"
                               Margin="40 7 0 0"
                               FontWeight="Medium"
                               Foreground="{DynamicResource SecondaryForegroundBrush}"/>

                        <Button Style="{StaticResource TransparentButton}" 
                                Command="{Binding LoadAuthenticatorCommand,Mode=OneTime}"
                                CommandParameter="{Binding RelativeSource={RelativeSource Self}}"
                                HorizontalAlignment="Right" Padding="0">
                            <Icon:PackIconMaterial Cursor="Hand"
                                           IsHitTestVisible="False"
                                           VerticalAlignment="Center"   
                                           Foreground="{DynamicResource LightBlueGrad}"
                                           HorizontalAlignment="Right" 
                                           Width="25" Height="25">
                                <Icon:PackIconMaterial.Style>
                                    <Style TargetType="Icon:PackIconMaterial">
                                        <Setter Property="Kind" Value="MinusCircle"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding CurrentAccount.Authenticator}" Value="{x:Null}">
                                                <Setter Property="Kind" Value="PlusCircle"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Icon:PackIconMaterial.Style>
                            </Icon:PackIconMaterial>
                        </Button>


                        <StackPanel Orientation="Vertical"
                                    Visibility="{Binding CurrentAccount.Authenticator,Mode=OneWay,Converter={StaticResource ToVisibilityConverter}}"
                                    Grid.Row="1" Margin="0 10 0 0"
                                    TextBlock.FontWeight="Medium">

                            <StackPanel Orientation="Horizontal" Margin="5 0 0 0">
                                <TextBlock Text="Revocation code:" Foreground="{DynamicResource SecondaryForegroundBrush}"
                                           VerticalAlignment="Center" FontWeight="Normal" Margin="0 0 5 0"/>
                                <TextBlock Text="R12345" 
                                           Cursor="Hand"
                                           MouseLeftButtonDown="ShowRevocationCode"
                                           Foreground="{DynamicResource  PrimarySubBrush}"
                                           FontSize="15">
                                    <TextBlock.Effect>
                                        <BlurEffect Radius="15"/>
                                    </TextBlock.Effect>
                                </TextBlock>
                            </StackPanel>


                            <StackPanel x:Name="TwoFaCodeBorder">
                                <Rectangle Margin="-10 10 -10 10"
                           Height="3" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                                <ItemsControl Margin="0 0 0 7"
                                          Cursor="Hand" Background="Transparent"
                                          d:ItemsSource="{d:SampleData ItemCount=1}"
                                          HorizontalAlignment="Center"
                                          ItemsSource="{Binding AuthenticatorCode,Mode=OneWay}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{DynamicResource BackgroundGrad}" 
                                                CornerRadius="3" Padding="0 1 0 2"
                                                Margin="3,0,3,0" Width="35">
                                                <TextBlock Text="{Binding}" 
                                                   FontSize="22" HorizontalAlignment="Center"
                                                   Foreground="{DynamicResource PrimarySubBrush}"/>
                                            </Border>

                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                    <ItemsControl.InputBindings>
                                        <MouseBinding Gesture="LeftClick" 
                                          Command="{Binding CopyAuthCodeCommand,Mode=OneTime}"
                                          CommandParameter="{Binding RelativeSource={RelativeSource AncestorLevel=1,AncestorType=ItemsControl}}"/>
                                    </ItemsControl.InputBindings>
                                </ItemsControl>

                                <ProgressBar x:Name="TokensGenProgress" Maximum="30" d:Value="20" Height="8"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>

            <Border CornerRadius="5"  Visibility="{Binding InteractionControlsVis,Mode=OneWay}"
                    Background="{DynamicResource SecondaryBackgroundBrush}"
                    Margin="0 10 0 0" Padding="10">
                    <Grid>
                        <Icon:PackIconMaterial Kind="AccountCircle"
                                           Width="30"
                                           Height="30"
                                           Foreground="{DynamicResource PrimarySubBrush}"/>

                        <TextBlock Text="Create shortcut on desktop"
                               VerticalAlignment="Top"
                               Margin="40 7 0 0"
                               FontWeight="Medium"
                               Foreground="{DynamicResource SecondaryForegroundBrush}"/>

                        <Icon:PackIconMaterial Kind="PlusCircle" Cursor="Hand"
                                               Background="Transparent"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource LightBlueGrad}"
                                               Height="25" Width="25">
                            <Icon:PackIconMaterial.InputBindings>
                                <MouseBinding Gesture="LeftClick"
                                              Command="{Binding CreateShortcutCommand,Mode=OneTime}"/>
                            </Icon:PackIconMaterial.InputBindings>
                        </Icon:PackIconMaterial>
                    </Grid>
                </Border>
            <!--#region Links -->
            
            <Border CornerRadius="5"
                    Background="{DynamicResource SecondaryBackgroundBrush}"
                    Margin="0 10 0 0" TextBlock.FontSize="14"
                    TextBlock.FontWeight="Medium">

                <StackPanel Visibility="{Binding AdditionalControlsVis,Mode=OneWay}">

                    <TextBlock Text="Games" Style="{StaticResource Links}" MouseLeftButtonDown="OpenOtherLink"/>

                    <Rectangle Height="2" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <TextBlock Text="Inventory"   Style="{StaticResource Links}"  MouseLeftButtonDown="OpenOtherLink"/>

                    <Rectangle Height="2" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <TextBlock Text="Friends" Style="{StaticResource Links}"  MouseLeftButtonDown="OpenOtherLink"/>

                    <Rectangle Height="2" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <TextBlock Text="Badges"  Style="{StaticResource Links}"  MouseLeftButtonDown="OpenOtherLink"/>

                    <Rectangle Height="2" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                    <TextBlock Text="Groups"  Style="{StaticResource Links}"  MouseLeftButtonDown="OpenOtherLink"/>

                </StackPanel>



            </Border>
            
            <!--#endregion-->

        </StackPanel>

        <!-- Main area -->
        <Border Margin="10 0 0 0"
                CornerRadius="5"
                MaxWidth="600" VerticalAlignment="Top"
                Width="500"
                Background="{DynamicResource SecondaryBackgroundBrush}">

            <TabControl SelectedIndex="{Binding SelectedTabIndex}">

                <TabItem Header="Profile" Tag="{x:Static Icon:PackIconMaterialKind.AccountCircleOutline}">

                        <StackPanel>

                            <!--#region Badges -->
                            <Grid x:Name="BadgesDock" Visibility="{Binding CurrentAccount.CreatedDate,Converter={StaticResource ToVisibilityConverter},Mode=OneWay}" VerticalAlignment="Top" Margin="15 25 15 15">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Border Background="{DynamicResource BackgroundGrad}"
                                Width="225" Height="150" HorizontalAlignment="Left"
                                CornerRadius="12" Margin="0 0 20 0"
                                Padding="15">
                                    <Grid>
                                        <Icon:PackIconMaterial Kind="Steam" Height="40" Width="40"
                                                       Foreground="{DynamicResource PrimarySubBrush}"/>

                                        <TextBlock Margin="50 10 0 0" VerticalAlignment="Top"
                                           FontSize="15" Text="Years of service"/>

                                        <TextBlock VerticalAlignment="Top"
                                           FontSize="13" TextWrapping="Wrap"
                                           MaxWidth="130"
                                           HorizontalAlignment="Left"
                                           Margin="0 68 0 0">
                                    <Run Text="Account registered"                                            FontWeight="Normal"/>
                                    <LineBreak/>
                                    <Run Text="{Binding CurrentAccount.CreatedDate,Mode=OneWay,StringFormat=f,ConverterCulture={x:Static glob:CultureInfo.CurrentCulture}}" Foreground="{DynamicResource PrimarySubBrush}"/>
                                        </TextBlock>


                                        <Rectangle HorizontalAlignment="Right"
                                               Visibility="{Binding YearImagePath,Mode=OneWay,Converter={StaticResource ToVisibilityConverter}}"
                                           RadiusY="5" RadiusX="5"
                                           Stroke="{DynamicResource PrimarySubBrush}"
                                           StrokeThickness="1"
                                           VerticalAlignment="Bottom"
                                           Height="50" Width="50">
                                            <Rectangle.Fill>
                                                <ImageBrush Opacity="0.7" ImageSource="{Binding YearImagePath,Mode=OneWay}"/>
                                            </Rectangle.Fill>
                                        </Rectangle>

                                    </Grid>
                                </Border>

                                <Border Background="{DynamicResource BackgroundGrad}"
                                    Visibility="{Binding CurrentAccount.GamesCount,Converter={StaticResource ToVisibilityConverter},Mode=OneWay}"
                                Width="225" Height="150"
                                HorizontalAlignment="Right"
                                CornerRadius="12"
                                Padding="15">
                                    <Grid>
                                        <Icon:PackIconMaterial Kind="GoogleController" Height="40" Width="40"
                                                       Foreground="{DynamicResource PrimarySubBrush}"/>

                                        <TextBlock Margin="50 10 0 0" VerticalAlignment="Top"
                                           FontSize="15" Text="Game collection"/>

                                        <TextBlock x:Name="GamesText" VerticalAlignment="Bottom"
                                           FontSize="13" MinWidth="140"
                                           HorizontalAlignment="Left"
                                           Margin="0 0 0 0">
                                    <Run Text="Games on account"                                            FontWeight="Normal"/>
                                    <LineBreak/>
                                    <Run Text="{Binding CurrentAccount.GamesCount,Mode=OneWay}" Foreground="{DynamicResource PrimarySubBrush}"/>
                                     <LineBreak/>
                                    <Run Text="Of them played"                                            FontWeight="Normal"/>
                                    <LineBreak/>
                                    <Run Text="{Binding GamesDetails,Mode=OneWay}" Foreground="{DynamicResource PrimarySubBrush}"/>
                                        </TextBlock>

                                        <Rectangle HorizontalAlignment="Right"
                                           VerticalAlignment="Bottom"
                                           Height="50" Width="50">
                                            <Rectangle.Fill>
                                                <ImageBrush Opacity="0.8" ImageSource="{Binding GamesImagePath,Mode=OneWay}"/>
                                            </Rectangle.Fill>
                                            <Rectangle.Style>
                                                <Style TargetType="Rectangle">
                                                    <Setter Property="Margin" Value="0 0 0 20"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=GamesText,Path=ActualWidth}" Value="140">
                                                            <Setter Property="Margin" Value="0"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Rectangle.Style>
                                        </Rectangle>

                                    </Grid>
                                </Border>

                                <Border Background="{DynamicResource BackgroundGrad}"
                                        Visibility="{Binding CurrentAccount.PaidGames,Mode=OneWay,Converter={StaticResource ToVisibilityConverter}}"
                                        Margin="0 15 0 0" Grid.Row="1"
                                        CornerRadius="12"
                                        Width="470" Height="90" Padding="15">
                                    <Grid>
                                        <Icon:PackIconMaterial Kind="Sack" Height="30" Width="30"
                                                       Foreground="{DynamicResource PrimarySubBrush}"/>

                                        <TextBlock Margin="40 5 0 0" VerticalAlignment="Top"
                                           FontSize="14" Text="Cost of games"/>

                                        <TextBlock VerticalAlignment="Bottom"
                                           FontSize="13"
                                           HorizontalAlignment="Left">
                                            <Run Text="Paid games" FontWeight="Normal"/>
                                            <Run Text="{Binding CurrentAccount.PaidGames,Mode=OneWay}" Foreground="{DynamicResource PrimarySubBrush}"/>
                                        </TextBlock>

                                        <TextBlock VerticalAlignment="Bottom"
                                           ToolTip="Without discounts. Prices are current at the time of the update"
                                           ToolTipService.InitialShowDelay="200"
                                           FontSize="20"
                                           HorizontalAlignment="Right"
                                           Text="{Binding CurrentAccount.TotalGamesPrice,Mode=OneWay}"
                                           Foreground="{DynamicResource SuccessGrad}"
                                           Margin="0 0 0 0"/>
                                    </Grid>
                                </Border>

                            </Grid>
                            <!--#endregion-->

                            <Rectangle Height="3" Margin="0 10 0 10" Fill="{DynamicResource PrimaryBackgroundBrush}"
                                   Visibility="{Binding ElementName=BadgesDock,Path=Visibility,Mode=OneWay}"/>

                            <!--#region Bans -->
                            <Grid Margin="15" Visibility="{Binding AdditionalControlsVis,Mode=OneWay}">

                                <StackPanel  HorizontalAlignment="Left">
                                    <ContentControl Uid="VAC ban" FocusVisualStyle="{x:Null}"
                                                Margin="0 0 0 15"
                                                Content="{Binding VacBanDetails,Mode=OneWay}"
                                                Tag="{Binding CurrentAccount.VacBansCount,Mode=OneWay}"
                                                Template="{StaticResource BanChipTemplate}"/>

                                    <ContentControl Uid="Community ban" FocusVisualStyle="{x:Null}"
                                                Content="The account is not allowed to interact with the Steam community. The details or date of the unban are unknown"
                                                Tag="{Binding CurrentAccount.HaveCommunityBan,Mode=OneWay}" 
                                                Template="{StaticResource BanChipTemplate}"/>
                                </StackPanel>


                                <StackPanel HorizontalAlignment="Right">

                                    <ContentControl Uid="Game ban" FocusVisualStyle="{x:Null}"
                                                Margin="0 0 0 15"
                                                d:Content="Bans received in some games: Counter Strike Global Offensive, Naraka Bladepoint"
                                                 Content="{Binding GameBanDetails,Mode=OneWay}"
                                                Tag="{Binding CurrentAccount.GameBansCount,Mode=OneWay}" d:Tag=""
                                                Template="{StaticResource BanChipTemplate}"/>

                                    <ContentControl Uid="Economy ban" FocusVisualStyle="{x:Null}"
                                                 Content="{Binding EconomyBanDetails,Mode=OneWay}"
                                                Tag="{Binding CurrentAccount.EconomyBan,Mode=OneWay}"
                                                Template="{StaticResource BanChipTemplate}"/>

                                </StackPanel>

                            </Grid>
                            <!--#endregion-->

                            <Rectangle Height="3" Margin="0 10 0 10" Fill="{DynamicResource PrimaryBackgroundBrush}"
                                   Visibility="{Binding AdditionalControlsVis,Mode=OneWay}"/>


                            <!--#region Credentials -->


                            <Expander Margin="15 10" x:Name="SteamExpander"
                                      Visibility="{Binding InteractionControlsVis,Mode=OneWay}"
                                      Tag="{x:Static Icon:PackIconMaterialKind.Fingerprint}"
                                      Uid="Steam credentials"  IsExpanded="{Binding IsSteamCredentialsExpanded}"
                                      OverridesDefaultStyle="True" Template="{StaticResource  ExpanderTemplate}">
                                <Expander.Header>
                                    <Icon:PackIconMaterial Kind="Alert" 
                                                       ToolTipService.InitialShowDelay="300"
                                                       Visibility="{Binding SteamCrenetialsErr,Mode=OneWay,Converter={StaticResource ToVisibilityConverter}}"
                                                       ToolTip="{Binding SteamCrenetialsErr,Mode=OneWay}"
                                                       Foreground="{DynamicResource ErrorBrush}" />
                                </Expander.Header>
                                <StackPanel HorizontalAlignment="Left" Width="300" TextBlock.FontWeight="Normal">

                                    <ext:TemplateDecorator Title="Steam login" Icon="{x:Static Icon:PackIconMaterialKind.Account}"
                                                       Margin="0 0 0 10">
                                        <TextBox Style="{StaticResource ModernTextBox}" MaxLength="32"
                                                 Height="35" PreviewTextInput="LoginPreviewTextInput"
                                                 Text="{Binding CurrentAccount.Login,Mode=OneTime}" 
                                                 IsReadOnly="True" IsReadOnlyCaretVisible="False"
                                     Foreground="{DynamicResource SecondaryForegroundBrush}"
                                     Background="{DynamicResource TertiaryBackgroundBrush}"/>
                                    </ext:TemplateDecorator>

                                    <ext:TemplateDecorator Title="Steam password" Icon="{x:Static Icon:PackIconMaterialKind.Key}"
                                                           Margin="0 0 0 10">
                                        <ext:PasswordBox CornerRadius="5" MaxLength="50"
                                                     Password="{Binding Password,UpdateSourceTrigger=PropertyChanged}"
                                                     SelectionBrush="{DynamicResource LightBlueGrad}"
                                                     IsPasswordShown="{Binding IsPasswordShown}"
                                                     Foreground="{DynamicResource SecondaryForegroundBrush}"
                                                     Background="{DynamicResource TertiaryBackgroundBrush}"/>
                                    </ext:TemplateDecorator>

                                    <ext:TemplateDecorator Title="Linked phone number" Icon="{x:Static Icon:PackIconMaterialKind.Phone}"
                                                       Margin="0 0 0 10">
                                        <TextBox Style="{StaticResource ModernTextBox}" MaxLength="15"
                                                 Height="35" PreviewTextInput="PhonePreviewTextInput"
                                                 Text="{Binding CurrentAccount.Phone,Mode=OneWay}"
                                                 LostFocus="TextBox_LostFocus"
                                                 Foreground="{DynamicResource SecondaryForegroundBrush}"
                                                 Background="{DynamicResource TertiaryBackgroundBrush}"/>

                                    </ext:TemplateDecorator>
                                </StackPanel>
                            </Expander>

                            <Rectangle Visibility="{Binding InteractionControlsVis,Mode=OneWay}" Height="3" Margin="0 10 0 10" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                            <Expander Margin="15 10" x:Name="LinksExpander"
                                      Visibility="{Binding InteractionControlsVis,Mode=OneWay}"
                                  Tag="{x:Static Icon:PackIconMaterialKind.LinkVariant}"
                                  IsExpanded="{Binding IsExternalCredentialsExpanded}"
                                  Uid="Credentials of external links"
                                  OverridesDefaultStyle="True" Template="{StaticResource  ExpanderTemplate}">
                                <Grid TextBlock.FontWeight="Normal">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="260"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>

                                    <ext:TemplateDecorator Title="E-mail address" Icon="{x:Static Icon:PackIconMaterialKind.At}"
                                                       Margin="0 0 0 10" >
                                        <TextBox Style="{StaticResource ModernTextBox}" Height="35"
                                             MaxLength="50"
                                             Text="{Binding ExternalEmail,Mode=TwoWay,UpdateSourceTrigger=LostFocus}"
                                     Foreground="{DynamicResource SecondaryForegroundBrush}"
                                     Background="{DynamicResource TertiaryBackgroundBrush}"/>
                                    </ext:TemplateDecorator>

                                    <ext:TemplateDecorator Title="Pasword" Icon="{x:Static Icon:PackIconMaterialKind.KeyLink}"
                                                       DockPanel.Dock="Bottom" Grid.Row="1">
                                        <ext:PasswordBox CornerRadius="5"
                                                     MaxLength="50"
                                                     Password="{Binding ExternalPassword,Mode=TwoWay,UpdateSourceTrigger=LostFocus}"
                                                     IsPasswordShown="{Binding IsPasswordShown}"
                                                     SelectionBrush="{DynamicResource LightBlueGrad}"
                                                     Foreground="{DynamicResource SecondaryForegroundBrush}"
                                                     Background="{DynamicResource TertiaryBackgroundBrush}"/>
                                    </ext:TemplateDecorator>

                                    <WrapPanel Grid.Column="1" 
                                               Grid.RowSpan="2"
                                               Margin="0 0 15 0"
                                               VerticalAlignment="Center" HorizontalAlignment="Right">
                                        <RadioButton Style="{StaticResource ZoomRadioButton}" Content="{StaticResource EmailIcon}" 
                                                     Margin="0 20 10 10" 
                                                     IsChecked="{Binding ExternalCredentialsChecked[0]}"
                                                     Command="{Binding SelectExternalCredentialCommand}"
                                                     ToolTip="Steam EMail"/>
                                        <RadioButton Style="{StaticResource ZoomRadioButton}" Content="{StaticResource UbisoftIcon}" 
                                                     Margin="0 20 0 10" 
                                                     IsChecked="{Binding ExternalCredentialsChecked[1]}"
                                                     Command="{Binding SelectExternalCredentialCommand}"
                                                     ToolTip="Ubisoft account"/>
                                        <RadioButton Style="{StaticResource ZoomRadioButton}" Content="{StaticResource RockstarIcon}" 
                                                     Margin="10 20 0 10" 
                                                     IsChecked="{Binding ExternalCredentialsChecked[2]}"
                                                     Command="{Binding SelectExternalCredentialCommand}"
                                                     ToolTip="Rockstar games account"/>
                                        <RadioButton Style="{StaticResource ZoomRadioButton}" Content="{StaticResource EpicGamesIcon}" 
                                                     Margin="0 0 10 0" 
                                                     IsChecked="{Binding ExternalCredentialsChecked[3]}"
                                                     Command="{Binding SelectExternalCredentialCommand}"
                                                     ToolTip="Epic games account"/>
                                        <RadioButton Style="{StaticResource ZoomRadioButton}" Content="{StaticResource EAIcon}" 
                                                     Margin="0 0 0 0" 
                                                     IsChecked="{Binding ExternalCredentialsChecked[4]}"
                                                     Command="{Binding SelectExternalCredentialCommand}"
                                                     ToolTip="Electronic arts account"/>
                                    </WrapPanel>
                                </Grid>
                            </Expander>
                            <!--#endregion-->

                            <Rectangle Visibility="{Binding InteractionControlsVis,Mode=OneWay}" Height="3" Margin="0 10 0 10" Fill="{DynamicResource PrimaryBackgroundBrush}"/>

                            <!--#region Note -->
                            <Border Margin="15" Background="{DynamicResource BackgroundGrad}" 
                                    CornerRadius="10" Padding="8" 
                                    Visibility="{Binding InteractionControlsVis,Mode=OneWay}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <Icon:PackIconMaterial Kind="NoteEdit"
                                                       Margin="5" Width="20"
                                                       Height="20"
                                                       Foreground="{DynamicResource PrimarySubBrush}"/>

                                    <TextBlock  Margin="35 -2 0 0" Text="Note abount account"
                                            VerticalAlignment="Center"/>

                                    <TextBox Grid.Row="1" Background="Transparent" BorderThickness="0"
                                         Text="{Binding CurrentAccount.Note,Mode=OneWay}"
                                         LostFocus="TextBox_LostFocus"
                                         FontWeight="Normal" MinHeight="80" MaxHeight="280"
                                         AcceptsReturn="True"
                                         VerticalScrollBarVisibility="Auto"
                                         AcceptsTab="True"
                                         Padding="3" MaxLength="300"
                                         FontSize="12"
                                         TextWrapping="Wrap" CaretBrush="{DynamicResource LightBlueGrad}"
                                         SelectionBrush="{DynamicResource LightBlueGrad}"
                                         Foreground="{DynamicResource SecondaryForegroundBrush}"/>

                                </Grid>
                            </Border>
                            <!--#endregion-->

                        </StackPanel>
                </TabItem>

                <TabItem Header="Games" Tag="{x:Static Icon:PackIconMaterialKind.GamepadVariantOutline}">
                     <DataGrid d:ItemsSource="{d:SampleData ItemCount=10}" 
                               VirtualizingPanel.VirtualizationMode="Recycling"
                               ItemsSource="{Binding Games,Mode=OneWay}" MaxHeight="756"
                               ScrollViewer.IsDeferredScrollingEnabled="True">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.Header>
                                        <Button Style="{StaticResource FlatButton}"
                                                Height="40" Width="135" Click="Button_Click">
                                            <Icon:PackIconMaterial Kind="TableSearch" Margin="0 3 0 0"/>
                                        </Button>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellStyle>
                                        <Style TargetType="DataGridCell" >
                                            <Setter Property="HorizontalAlignment" Value="Left"/>
                                            <Setter Property="Margin" Value="10 0 0 0"/>
                                            <Setter Property="MinHeight" Value="56"/>
                                            <Setter Property="MinWidth" Value="120"/>
                                            <Setter Property="Tag" Value="{StaticResource GamesContextMenu}"/>
                                            <Setter Property="Template" Value="{StaticResource ContainerTemplate}"/>
                                        </Style>
                                    </DataGridTemplateColumn.CellStyle>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="Name"  
                                                    Binding="{Binding Name,Mode=OneTime}"
                                                    IsReadOnly="True" Width="150"
                                                    ElementStyle="{DynamicResource DataGridTextBlock}" 
                                                    Foreground="{DynamicResource PrimaryForegroundBrush}"/>

                                <DataGridTextColumn Header="ID" Binding="{Binding AppID,Mode=OneTime}" 
                                                    IsReadOnly="True" Width="70" 
                                                    TextBlock.TextAlignment="Center"
                                                    ElementStyle="{StaticResource DataGridTextBlockCenter}"/>
                                <DataGridTextColumn Header="Time" 
                                                    Binding="{Binding Playtime_forever,Mode=OneTime,StringFormat={}{0:N0} h}"
                                                    IsReadOnly="True" Width="60"
                                                    ElementStyle="{StaticResource  DataGridTextBlockCenter}" />
                                <DataGridTextColumn Header="Price"  
                                                    Binding="{Binding FormattedPrice,Mode=OneTime,TargetNullValue=—}" 
                                                    IsReadOnly="True" Width="*"
                                                    Foreground="{DynamicResource SuccessGrad}"
                                                    ElementStyle="{StaticResource  DataGridTextBlockCenter}" />
                            </DataGrid.Columns>
                      </DataGrid>
                </TabItem>
                
                <TabItem Header="Friends" Tag="{x:Static Icon:PackIconMaterialKind.AccountGroupOutline}">
                        <DataGrid d:ItemsSource="{d:SampleData ItemCount=10}" 
                                  VirtualizingPanel.VirtualizationMode="Recycling"
                                  ItemsSource="{Binding Friends,Mode=OneWay}" MaxHeight="756"
                                  ScrollViewer.IsDeferredScrollingEnabled="True">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.Header>
                                        <Button Style="{StaticResource FlatButton}" Click="Button_Click"
                           Height="40" Width="100">
                                            <Icon:PackIconMaterial Kind="TableSearch" Margin="0 3 0 0"/>
                                        </Button>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellStyle>
                                        <Style TargetType="DataGridCell" >
                                            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                            <Setter Property="HorizontalAlignment" Value="Left"/>
                                            <Setter Property="Margin" Value="10 0 5 0"/>
                                            <Setter Property="MinHeight" Value="56"/>
                                            <Setter Property="MinWidth" Value="56"/>
                                            <Setter Property="Tag" Value="{StaticResource FriendsContextMenu}"/>
                                            <Setter Property="Template" Value="{StaticResource ContainerTemplate}"/>
                                        </Style>
                                    </DataGridTemplateColumn.CellStyle>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="Nickname"  
                               Binding="{Binding PersonaName,Mode=OneTime}"
                               IsReadOnly="True" Width="150"
                               ElementStyle="{DynamicResource DataGridTextBlock}" 
                               Foreground="{DynamicResource PrimaryForegroundBrush}"/>

                                <DataGridTextColumn Header="ID" Binding="{Binding SteamID,Mode=OneTime}" 
                               IsReadOnly="True" Width="*" 
                               TextBlock.TextAlignment="Center"
                               ElementStyle="{StaticResource DataGridTextBlockCenter}"/>
                                <DataGridTextColumn Header="Friend since" 
                               Binding="{Binding Friend_since,Mode=OneTime,StringFormat=d}"
                               IsReadOnly="True" Width="*"
                               ElementStyle="{StaticResource  DataGridTextBlockCenter}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </TabItem>
            </TabControl>
            
        </Border>

    </DockPanel>
    </ScrollViewer>

    <TextBlock VerticalAlignment="Top" IsHitTestVisible="False"
               HorizontalAlignment="Center" Margin="280 150 0 0"
               FontSize="40" FontWeight="Bold" Foreground="{DynamicResource PrimaryForegroundBrush}">
        <TextBlock.Style>
            <Style TargetType="TextBlock">
                <Setter Property="Text" Value=""/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding LoadingState}" Value="1">
                        <Setter Property="Text" Value="No results"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding LoadingState}" Value="2">
                        <Setter Property="Text" Value="Loading. . ."/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
    </TextBlock>

    <Button Style="{StaticResource FlatButton}" VerticalAlignment="Top"
            Command="{Binding BackCommand,Mode=OneTime}"
            Opacity="0.8" ToolTip="Back to accounts" ToolTipService.InitialShowDelay="300"
            HorizontalAlignment="Left" Width="25" Height="25" Margin="10 10 0 0">
        <Icon:PackIconMaterial Kind="ArrowLeftThick" Width="20" Height="20" />
    </Button>
</Grid>
